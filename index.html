<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" alt="Logo" />
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="general">General</h1>

<p>TeacherGaming Desk, our learning platform, aims to demystify the processes behind game-based learning. It aims to provide educators with an easily understandable way of tracking and assessing the learning that happens in-game.</p>

<p>In more technical terms, the analytics part of TeacherGaming Desk is a web-based platform that collects analytics information (events) sent by games and processes it to reveal what the students (users, players) have learned while playing the game. The SDK for integrating the analytics is called TGA SDK for short.</p>

<p>This document is written for game developers that are going to integrate TeacherGaming Desk analytics into their games. It describes on a general level how to do the integration. Integration can be done either by using a ready-made SDK for your platform, or by manually using the HTTP API. More detailed information is available in the specific documents for the different SDKs and the HTTP API documentation.</p>

<h2 id="student-login">Student Login</h2>

<h3 id="student-id-and-class-id">Student ID and Class ID</h3>

<p>Students are identified in TGA by their class and student ids. These are used instead of real names or similar in order to prevent outsiders (anyone except their teachers or parents etc.) from identifying individual students in the system. The class id is a system-wide unique generated alphanumeric identifier that identifies a group of students (usually a class). The student id is an alphanumeric identifier that is unique within a class, and is manually set either by a teacher in the web interface or by the student on first login if automatic generation of students has been allowed for that class.</p>

<p>TeacherGaming Desk analytics (TGA) requires the game to send a class id and a student id for each student playing the game to assign data to the right student. This means that students need to login before data can be sent, except for anonymous event data.</p>

<p>Logging in can be done through the TeacherGaming app (Android only at the moment) or in the game. If users authenticate in the game you will need to add a UI where the student can type in a class id and a student id.</p>

<p>You should not save the class and student id’s in your game. The student should need to login separately every time the app is started, either through the TG App or in the game UI.</p>

<h2 id="creating-ui-for-in-game-authentication">Creating UI for In-game Authentication</h2>

<p>For manually logging in to TGA the student needs to be able to input a Class ID and a Student ID. A good place for this UI is for example in a settings menu, or somewhere in the main menu. Usually two input fields with OK and Cancel options is enough. You can also have a Logout button to logout of TGA. Both the Class ID and Student ID fields should be either lowercase or uppercase only, not mixed case. In the system the Class ID and Student ID are not case sensitive. Uppercase only can be used to make it easier for young children to type the ids.</p>

<h3 id="login-ui-examples">Login UI Examples</h3>

<p><img src="images/general/tga_login_1.png" title="Login Example 1" alt="Login Example 1" /></p>

          <h1 id="oauth">oAuth</h1>

<p>Desk works as oAuth 2 identity provider server. To gain access to these features, please contact us to get your <code class="prettyprint">client_id</code> and <code class="prettyprint">client_secret</code> generated for you.</p>

<p>In a nutshell:</p>

<ol>
<li>Request your <code class="prettyprint">client_id</code> and <code class="prettyprint">client_secret</code> from TeacherGaming</li>
<li>Redirect user to login URL as mentioned in section <a href="#authorization">Authorization</a></li>
<li>User gets redirected to your specified URL, you will get code as parameter. Call our <a href="#token">Token</a> endpoint to exchange that code for token</li>
<li>Verify that token is correct and user is correct by calling our <a href="#user-profile">Profile</a> endpoint.</li>
</ol>

<h2 id="authorization">Authorization</h2>

<p>We currently support authorization code flow. You will need to redirect the user to our request URL and pass the additional parameters.</p>

<h3 id="request">Request</h3>

<p><code class="prettyprint">GET https://analyticsdata.teachergaming.com/api/oauth/authorize</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>client_id</td>
<td></td>
<td>Your <code class="prettyprint">client_id</code>.</td>
</tr>
<tr>
<td>redirect_uri</td>
<td></td>
<td>URL where client gets redirected after succesfull login. These are whitelisted by Teachergaming.</td>
</tr>
<tr>
<td>student_login</td>
<td></td>
<td>Set to true to login as a student. Do not include this parameter if doing teacher login.</td>
</tr>
<tr>
<td>response_type</td>
<td></td>
<td>only <code class="prettyprint">code</code> allowed for now.</td>
</tr>
</tbody></table>

<p>After succesfull login, user will be redirected back to your redirect_uri with code in GET query parameter. Use this code to fetch the token for the user as explained in section <a href="#token">Token</a>.</p>

<h2 id="token">Token</h2>

<p>This endpoint can be used to exchange oauth code with token.</p>

<h3 id="request">Request</h3>

<p><code class="prettyprint">GET https://analyticsdata.teachergaming.com/api/oauth/token</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<blockquote>
<p><span style="color: green">Example Success Output</span></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Token created succesfully."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"responseCreatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-07-26T09:47:48.733Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;YourToken&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"service"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;ServiceName&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p><span style="color: red">Example Failed Output</span></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Code not found."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>client_id</td>
<td></td>
<td>Your <code class="prettyprint">client_id</code>.</td>
</tr>
<tr>
<td>client_secret</td>
<td></td>
<td>Your <code class="prettyprint">client_secret</code>.</td>
</tr>
<tr>
<td>student_login</td>
<td></td>
<td>Set to true if student. Do not include this parameter if teacher.</td>
</tr>
<tr>
<td>code</td>
<td></td>
<td>Code you got from us in the <a href="#Authorization">Authorization</a> section.</td>
</tr>
</tbody></table>

<h2 id="user-profile">User Profile</h2>

<p>This endpoint returns information about the user. Requires valid token. This method is useful for verifying that the user information like email address is correct after getting token for a user.</p>

<h3 id="request">Request</h3>

<p><code class="prettyprint">GET https://analyticsdata.teachergaming.com/api/oauth/profile</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<blockquote>
<p><span style="color: green">Example Success Output</span></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Profile information fetched succesfully."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"responseCreatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-07-26T09:51:01.858Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"isStudent"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;userEmail&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p><span style="color: red">Example Failed Output</span></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Token not found."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>client_id</td>
<td></td>
<td>Your <code class="prettyprint">client_id</code>.</td>
</tr>
<tr>
<td>client_secret</td>
<td></td>
<td>Your <code class="prettyprint">client_secret</code>.</td>
</tr>
<tr>
<td>student_login</td>
<td></td>
<td>Set to true if student. Do not include this parameter if teacher.</td>
</tr>
<tr>
<td>token</td>
<td></td>
<td>Your token.</td>
</tr>
</tbody></table>

<h2 id="revoke-token">Revoke Token</h2>

<p>This endpoint can be used to revoke a token.</p>

<h3 id="request">Request</h3>

<p><code class="prettyprint">GET https://analyticsdata.teachergaming.com/api/oauth/revoke</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<blockquote>
<p><span style="color: green">Example Success Output</span></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Token revoked succesfully."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"responseCreatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-07-26T10:03:45.218Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p><span style="color: red">Example Failed Output</span></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Token not found."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>client_id</td>
<td></td>
<td>Your <code class="prettyprint">client_id</code>.</td>
</tr>
<tr>
<td>client_secret</td>
<td></td>
<td>Your <code class="prettyprint">client_secret</code>.</td>
</tr>
<tr>
<td>student_login</td>
<td></td>
<td>Set to true if student. Do not include this parameter if teacher.</td>
</tr>
<tr>
<td>token</td>
<td></td>
<td>Your token.</td>
</tr>
</tbody></table>

          <h1 id="unity-c-sdk">Unity C# SDK</h1>

<h2 id="general">General</h2>

<p>This document describes the specifics of integrating TGA to your game using the TGA Unity C# SDK. For general integration information and links to other SDK documents see the general SDK instructions.</p>

<h3 id="requirements">Requirements</h3>

<p>Our current SDK requires Unity 4.0.0f7 or later. If you need an SDK for an earlier version of Unity please contact us.</p>

<h3 id="first-steps">First steps</h3>

<ul>
<li>TeacherGaming will send you a .unitypackage with the latest SDK and assets.</li>
<li>Import the package by selecting “Assets -&gt; Import package -&gt; Custom package” in Unity.</li>
<li>Attach the SDK script to a GameObject that is not deleted during the game. The script is located in “TGAGameSpecific/” folder and is named TGASDK<yourgamenamehere>.cs</li>
<li>Updating the SDK and assets can usually be done by simply importing new package and updated files will automatically be detected.

<ul>
<li>If you are having problems and would like to try a complete reimport of the SDK, you can delete the following directories &amp; files before importing the package

<ul>
<li>TGA</li>
<li>TGAGameSpecific</li>
<li>StreamingAssets/TGA</li>
<li>Plugins/Android/AndroidManifest.xml</li>
</ul></li>
<li>In older versions of the SDK you needed to manually attach the CreatubblesManager script to a GameObject. You no longer need to do this and should remove it if you have attached it previously.</li>
</ul></li>
</ul>

<h3 id="notes">Notes</h3>

<p>Your game specific SDK file is called TGASDK<yourgamenamehere>.cs. Class inside that file is called TGASDK<yourgamenamehere>. To improve readability, we have not added <yourgamenamehere> for each method call in this document, we are mentioning TGASDK and you should add your game name after each TGASDK call to make it correct.</p>

<h2 id="student-login">Student login</h2>

<p>Logging in can be done through the TeacherGaming app (Android only at the moment) or in game. If users authenticate in game you will need to add a menu where user can type in a classid and a studentid. Authentication must be done before data can be sent.</p>

<h3 id="automatically-logging-in-with-tg-app">Automatically logging in with TG App</h3>
<pre class="highlight csharp tab-csharp"><code><span class="c1">// Automatically logging in with TG App</span>
<span class="c1">// Login status delegate &amp; event (in TGASDK.TGA)</span>
<span class="k">public</span> <span class="k">delegate</span> <span class="k">void</span> <span class="nf">LoginStatusListener</span><span class="p">(</span><span class="kt">bool</span> <span class="n">isLoggedIn</span><span class="p">);</span>
<span class="k">public</span> <span class="k">static</span> <span class="k">event</span> <span class="n">LoginStatusListener</span> <span class="n">OnLoginStatusChanged</span><span class="p">;</span>
</code></pre><pre class="highlight xml tab-xml"><code><span class="c">&lt;!-- AndroidManifest.xml --&gt;</span>
<span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">"com.teachergaming.tga.TGAAndroidUriSchemeActivity"</span>
        <span class="na">android:label=</span><span class="s">"@string/app_name"</span>
        <span class="na">android:launchMode=</span><span class="s">"singleTop"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
      <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"android.intent.action.VIEW"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"android.intent.category.DEFAULT"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"android.intent.category.BROWSABLE"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;data</span> <span class="na">android:scheme=</span><span class="s">"&lt;your bundle identifier&gt;"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/activity&gt;</span>
</code></pre><pre class="highlight plaintext"><code>You can test automatic login using the following URI format
&lt;your bundle identifier&gt;://?classid=&lt;class id&gt;&amp;studentid=&lt;student id&gt;&amp;command=&lt;login/logout&gt;
</code></pre>
<p>Logging in via TG APP is automatically handled by the SDK. You can listen to the TGASDK.TGA.OnLoginStatusChanged C# event to get notified when the login status changes. The event gives you one boolean parameter that is true if a student logged in and false if the current student logged out. The event is implemented using the C# delegate &amp; event system.</p>

<p>You can use the TGASDK.TGA.LoggedInExternally() to check if the user logged in using the TG App.</p>

<p>Note for Android! In future versions of TG App we are moving to use URI schemes to forward the login parameters to games on Android, like we already do on iOS. For this to work you need to add the com.teachergaming.tga.TGAAndroidUriSchemeActivity activity to your AndroidManifest.xml file in Assets/Plugins/Android. (see https://docs.unity3d.com/Manual/android-manifest.html)</p>

<p>On Android and iOS you should test the uri scheme login by creating a .html file with links according to the URI schem and opening it in your device browser and clicking on the links.</p>

<p>On desktop platforms you should test the automatic login by giving the uri as a command line parameter when starting your game. See https://docs.google.com/document/d/1nEJ5EGwO6JxTTmJGixvxEcBb0VhpMN7sEfOjGHY4JkI/edit#heading=h.1u1ow8hobpr for details.</p>

<h3 id="built-in-login-menu">Built-in login menu</h3>
<pre class="highlight csharp tab-csharp"><code><span class="c1">// Built-in login menu</span>
<span class="c1">// Using the built-in login menu</span>

<span class="c1">// First check that not already logged in externally</span>
<span class="k">if</span> <span class="p">(!</span><span class="n">TGASDK</span><span class="p">.</span><span class="n">TGA</span><span class="p">.</span><span class="nf">LoggedInExternally</span><span class="p">())</span>
<span class="p">{</span>
    <span class="c1">// Then show the login UI</span>
    <span class="n">TGASDK</span><span class="p">.</span><span class="n">TGA</span><span class="p">.</span><span class="nf">CreateLoginPanel</span><span class="p">();</span>
<span class="p">}</span>
</code></pre>
<p>The TGA Unity C# SDK can create a ready made UI that has all the authentication functionality built in. See the code example on the right on how to use it.
A login dialog will be created that looks like this (without the blue background)</p>

<p><img src="images/integrations/unitycsharp/image6.png" title="UnityCSharp Login Example" alt="UnityCSharp Login Example" /></p>

<p>This dialog will inform user if the login failed or succeeded. As with login via TG App you can listen to the TGASDK.TGA.OnLoginStatusChanged event to get notified when the login status changes.</p>

<h3 id="handling-subscription-required">Handling subscription required</h3>

<p>You can define the compile time symbol TGA_SUBSCRIPTION_REQUIRED to make the login menu require a subscription. If the symbol is defined you cannot close the login menu. Pressing X in the top-right corner will quit the application by calling Application.Quit(). You can also supply your own function for quitting as a parameter for TGASDK.TGA.CreateLoginPanel() for example if you need to bypass your Monobehaviour.OnApplicationQuit handler that calls Application.CancelQuit.</p>

<h3 id="custom-login-menu">Custom login menu</h3>
<pre class="highlight csharp tab-csharp"><code><span class="c1">// Custom login menu</span>
<span class="c1">// Logging in from code</span>

<span class="c1">// Create new Auth object and start authentication</span>
<span class="n">TGASDK</span><span class="p">.</span><span class="n">TGA</span><span class="p">.</span><span class="n">TGAAuth</span> <span class="n">tgaAuth</span> <span class="p">=</span> <span class="k">new</span> <span class="n">TGASDK</span><span class="p">.</span><span class="n">TGA</span><span class="p">.</span><span class="nf">TGAAuth</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">TGASDK</span><span class="p">.</span><span class="n">TGA</span><span class="p">.</span><span class="n">TGAAuth</span><span class="p">.</span><span class="nf">AuthUser</span><span class="p">(</span><span class="k">class</span><span class="nc">ID</span><span class="p">,</span> <span class="n">studentID</span><span class="p">));</span>

<span class="c1">// Wait for auth result</span>
<span class="k">yield</span> <span class="k">return</span> <span class="n">tgaAuth</span><span class="p">.</span><span class="n">authResult</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="n">tgaAuth</span><span class="p">.</span><span class="n">authResult</span><span class="p">.</span><span class="nf">Equals</span><span class="p">(</span><span class="s">"true"</span><span class="p">))</span>
<span class="p">{</span>
    <span class="c1">// Authentication succeeded (classid &amp; studentid we’re correct)</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="c1">// Authentication failed (classid &amp; studentid we’re not correct)</span>
<span class="p">}</span>
</code></pre>
<p>Note: If a student has logged in externally (using TG App) your custom login menu should not allow changing the login nor logging out. You can check if the user has logged in externally using TGASDK.TGA.LoggedInExternally(). It is recommended you still have the UI to show the class and student ids. This can be the same UI you use to login inside the game just having the input fields and buttons in a disabled state disabled for example.</p>

<p>If you choose to create your own login menu you need to pass the class id and student id to the auth process. From a Monobehaviour script you need to run a coroutine with the code on the right.</p>

<p>You can also listen to the TGASDK.TGA.OnLoginStatusChanged event to get notified when the login status changes.</p>

<h2 id="sending-events">Sending events</h2>

<p>The events that have been defined in TeacherGaming Desk website are generated to the SDK and can be used to send data from the game to Desk. All the events have their own inner class inside TGA<yourgamename>.Event with a property for each event parameter and functions to start and send the event.</p>

<h3 id="sending-events-with-duration">Sending events with duration</h3>
<pre class="highlight csharp tab-csharp"><code><span class="c1">// This is an example with our game Switch N’ Glitch.</span>

<span class="c1">/// When the player enters a singleplayer level, in our StartGame() function </span>
<span class="n">TGASDKSwitchGlitch</span><span class="p">.</span><span class="n">Event</span><span class="p">.</span><span class="n">SPLevelComplete</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span> 

<span class="c1">// And when the player has completed the level:</span>
<span class="n">TGASDKSwitchGlitch</span><span class="p">.</span><span class="n">Event</span><span class="p">.</span><span class="n">SPLevelComplete</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">LevelId</span> <span class="p">=</span> <span class="n">Client</span><span class="p">.</span><span class="n">UIActiveClient</span><span class="p">.</span><span class="n">LocalGame</span><span class="p">.</span><span class="n">GameBoard</span><span class="p">.</span><span class="n">PrefabPath</span><span class="p">;</span>
<span class="n">TGASDKSwitchGlitch</span><span class="p">.</span><span class="n">Event</span><span class="p">.</span><span class="n">SPLevelComplete</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">FailedCommandCount</span> <span class="p">=</span> <span class="n">player</span><span class="p">.</span><span class="n">failedTileCount</span><span class="p">;</span>
<span class="n">TGASDKSwitchGlitch</span><span class="p">.</span><span class="n">Event</span><span class="p">.</span><span class="n">SPLevelComplete</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">CommitCount</span> <span class="p">=</span> <span class="n">player</span><span class="p">.</span><span class="n">totalCommitCount</span><span class="p">;</span>
<span class="n">TGASDKSwitchGlitch</span><span class="p">.</span><span class="n">Event</span><span class="p">.</span><span class="n">SPLevelComplete</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">OptimalCommitsForLevel</span> <span class="p">=</span> <span class="n">Client</span><span class="p">.</span><span class="n">UIActiveClient</span><span class="p">.</span><span class="n">LocalGame</span><span class="p">.</span><span class="n">GameBoard</span><span class="p">.</span><span class="n">programExecutionsGoal</span><span class="p">;</span>
<span class="n">TGASDKSwitchGlitch</span><span class="p">.</span><span class="n">Event</span><span class="p">.</span><span class="n">SPLevelComplete</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">MetagelCollected</span> <span class="p">=</span> <span class="n">player</span><span class="p">.</span><span class="n">playerScore</span><span class="p">;</span>
<span class="n">TGASDKSwitchGlitch</span><span class="p">.</span><span class="n">Event</span><span class="p">.</span><span class="n">SPLevelComplete</span><span class="p">.</span><span class="nf">Send</span><span class="p">();</span>
</code></pre>
<p>This is useful for events that have a clear start and end times and as such a duration. Our SDK can automatically count time from beginning to end and append duration to sent data. You can also modify any additional data inside the event before you send it.
To start an event, call TGASDK.Event.<EventName>.Start()
You can change additional data inside the event before you send it. All data for the started event can be changed using TGASDK.Event.<EventName>.Current.<ParameterName>
To send the event, call TGASDK.Event.<EventName>.Send() without parameters.</p>

<h3 id="sending-events-without-duration">Sending events without duration</h3>
<pre class="highlight csharp tab-csharp"><code><span class="c1">// Sending an event without duration</span>

<span class="c1">// This example is from KerbalEdu</span>
<span class="n">TGASDKKerbalEdu</span><span class="p">.</span><span class="n">Event</span><span class="p">.</span><span class="n">SituationChange</span><span class="p">.</span><span class="nf">Send</span><span class="p">(</span><span class="n">FlightGlobals</span><span class="p">.</span><span class="n">ActiveVessel</span><span class="p">.</span><span class="n">mainBody</span><span class="p">.</span><span class="n">bodyName</span><span class="p">,</span> <span class="n">FlightGlobals</span><span class="p">.</span><span class="n">ActiveVessel</span><span class="p">.</span><span class="n">situation</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(),</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">FlightGlobals</span><span class="p">.</span><span class="n">ActiveVessel</span><span class="p">.</span><span class="n">totalMass</span><span class="p">);</span>
</code></pre>
<p>You can call TGASDK.Event.<EventName>.Send(&hellip;) with event data as parameters to send an event immediately, without tracking for duration.</p>

<h2 id="updating-state">Updating state</h2>

<p>Updating state can be done using one of three function calls</p>

<ul>
<li>TGASDK.TGA.UpdateUserState(string state)

<ul>
<li>This sets the state showing below student name in teacher dashboard. It also resets detailed state showing below this state, if there was any.</li>
</ul></li>
<li>TGASDK.TGA.UpdateUserState(string state, string detailedState)

<ul>
<li>This sets the state showing below student name in teacher dashboard and detailed state below it.</li>
</ul></li>
<li>TGASDK.TGA.UpdateUserStateDetailedOnly(string stateDetailed)

<ul>
<li>This sets the detailed state below main state and does not reset the main state. You can use this to for ex. Update round numbers or other live data happening in current state of your game.</li>
</ul></li>
</ul>

<p>You can keep the state update calls in your game and don’t need to check if user is logged in to TGA, we will automatically check inside the function calls if player is currently authenticated to TGA and send the state update only if so.</p>

<h3 id="state-examples">State examples</h3>

<p>Default state for logged-in student</p>

<p><img src="images/integrations/unitycsharp/image5.png" title="Default state for logged in student" alt="Default state for logged in student" /></p>

<p>Student is in main menu</p>
<pre class="highlight csharp tab-csharp"><code><span class="n">TGASDK</span><span class="p">.</span><span class="n">TGA</span><span class="p">.</span><span class="nf">UpdateUserState</span><span class="p">(</span><span class="s">"In Main Menu"</span><span class="p">);</span>
</code></pre>
<p><img src="images/integrations/unitycsharp/image4.png" title="Student is in main menu" alt="Student is in main menu" /></p>

<p>Student is in settings menu</p>
<pre class="highlight csharp tab-csharp"><code><span class="n">TGASDK</span><span class="p">.</span><span class="n">TGA</span><span class="p">.</span><span class="nf">UpdateUserState</span><span class="p">(</span><span class="s">"In Settings Menu"</span><span class="p">);</span>
</code></pre>
<p><img src="images/integrations/unitycsharp/image2.png" title="Student is in settings menu" alt="Student is in settings menu" /></p>

<p>Student is playing singleplayer game, Tutorial Level 4 has been passed for detailed state</p>
<pre class="highlight csharp tab-csharp"><code><span class="n">TGASDK</span><span class="p">.</span><span class="n">TGA</span><span class="p">.</span><span class="nf">UpdateUserState</span><span class="p">(</span><span class="s">"Playing Singleplayer Game"</span><span class="p">,</span> <span class="s">"Tutorial Level 4"</span><span class="p">);</span>
</code></pre>
<p><img src="images/integrations/unitycsharp/image1.png" title="Student is playing singleplayer game, Tutorial Level 4" alt="Student is playing singleplayer game, Tutorial Level 4" /></p>

<p>Student is playing multiplayer game, Round number is being passed to detailed state when round changes</p>
<pre class="highlight csharp tab-csharp"><code><span class="c1">// When game begun</span>
<span class="n">TGASDK</span><span class="p">.</span><span class="n">TGA</span><span class="p">.</span><span class="nf">UpdateUserState</span><span class="p">(</span><span class="s">"Playing Multiplayer Game"</span><span class="p">);</span>
<span class="c1">// When round changed</span>
<span class="n">TGASDK</span><span class="p">.</span><span class="n">TGA</span><span class="p">.</span><span class="nf">UpdateUserStateDetailedOnly</span><span class="p">(</span><span class="s">"Round 2"</span><span class="p">);</span>
</code></pre>
<p><img src="images/integrations/unitycsharp/image3.png" title="Student is playing multiplayer game, Round number is being passed to detailed state" alt="Student is playing multiplayer game, Round number is being passed to detailed state" /></p>

<h2 id="creatubbles">Creatubbles</h2>

<p>Creatubbles integration can be used to take a screenshot of the game and send it to TGA and Creatubbles web page. To use this feature the user needs to be logged in to TGA and the CreatubblesManager script needs to be attached to a gameobject as explained in the FIRST STEPS section.</p>

<h3 id="usage">Usage</h3>
<pre class="highlight csharp tab-csharp"><code><span class="c1">/// Creatubbles</span>
<span class="n">TGASDK</span><span class="p">.</span><span class="n">TGA</span><span class="p">.</span><span class="nf">ScreenShotToCreatubbles</span><span class="p">();</span>
</code></pre>
<p>To send a screenshot to TGA you can simply call TGASDK.TGA.ScreenShotToCreatubbles(). This will take a screenshot and open a UI that shows you the image that would be sent and where you can enter a description for the screenshot.
<img src="images/integrations/unitycsharp/image7.png" title="Creatubbles UI" alt="Creatubbles UI" /></p>

<p>For example you can create a simple button to send the screenshot and show it in your in-game UI. There is a camera texture in the “TGA/Resources/Graphics/” folder that you can use with the button if you wish.</p>

<h2 id="getting-information">Getting information</h2>

<h3 id="general-information">General information</h3>
<pre class="highlight csharp tab-csharp"><code><span class="c1">// General information</span>

<span class="c1">// Call example: TGASDK.TGA.IsUserLoggedIn()</span>

<span class="c1">// Login information</span>

<span class="c1">// Returns true if logged into TGA, otherwise false.</span>
<span class="kt">bool</span> <span class="nf">IsUserLoggedIn</span><span class="p">()</span>

<span class="c1">// Returns true if logged into TGA via broadcast (TGA App), otherwise false.</span>
<span class="kt">bool</span> <span class="nf">LoggedInExternally</span><span class="p">()</span>

<span class="c1">// Returns the student ID used for login.</span>
<span class="kt">string</span> <span class="nf">GetStudentId</span><span class="p">()</span>

<span class="c1">// Returns the class ID used for login.</span>
<span class="kt">string</span> <span class="nf">GetClassId</span><span class="p">()</span>
</code></pre>
<p>Here (on the right) are some functions you can use to get status information about TGA. All of these are static functions of TGASDK.TGA.</p>

<h3 id="subscription-information">Subscription information</h3>
<pre class="highlight csharp tab-csharp"><code><span class="c1">// Subscription information</span>

<span class="c1">// Returns true if game subscription has expired, otherwise false.</span>
<span class="kt">bool</span> <span class="nf">SubscriptionExpired</span><span class="p">()</span>

<span class="c1">// Returns the message that should be shown to user if the subscription has expired</span>
<span class="kt">string</span> <span class="nf">SubscriptionExpiredMessage</span><span class="p">()</span>
</code></pre>
<p>These functions can be used to query if there is a valid subscription for the game. For testing the subscription, there are these two classes: Class h1xme never has subscription expired. Class h1xjr always has subscription expired. Both of these classes have student self-signup enabled so user can login with any studentid for testing.</p>

          <h1 id="http-api">HTTP API</h1>

<p>Our HTTP API can be used if our system does not yet support your programming language / game engine.</p>

<p>Basically, just send data to our REST API through standard HTTPS calls. All data passed needs to be inside the GET query string. Note that for compatibility with special characters, you are always required to URL encode all data sent to our API.</p>

<h2 id="in-game-flow">In-game Flow</h2>

<ol>
<li>User login

<ul>
<li>Successful login needs to be done before any data can be sent to TGA (except anonymous event data)</li>
</ul></li>
<li> Start calling playing game once every 60 seconds

<ul>
<li>After login is successful. This will inform the TGA system that the user is currently playing the game and the user can be tracked. Also the TGA Teacher Dashboard shows that the user is currently playing the game.</li>
</ul></li>
<li> Update player state as it changes in game

<ul>
<li>This information will be shown on the Teacher Dashboard on the TGA website so that the Teacher can easily see what the students are currently doing in game.</li>
</ul></li>
<li> Send event data

<ul>
<li>Events and the data in them have been set up on the TGA website by TeacherGaming. This is the data that is needed to track student progress.</li>
</ul></li>
</ol>

<h2 id="login-student">Login Student</h2>

<blockquote>
<p>Example Output</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Student with this ID exists in this class."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"responseCreatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-06-13T07:08:47.763Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"debug"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"sent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-15T12:05:35.722Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"container"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zo5jajsD99beDQyt7-pv0n"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"login_message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Logged into class &lt;classid&gt; with studentid &lt;studentid&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"login_message_html"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Logged into class &lt;b&gt;classid&lt;/b&gt; with studentid &lt;b&gt;studentid&lt;/b&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"subscription"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"subscription_expired"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"subscription_expired_message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Your subscription has expired."</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"student"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"studentid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;studentid&gt;"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"studentid_unique"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;HashedUniqueStudentID&gt;"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"created_account"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"teacher_creatubbles_linked"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="s2">"class"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"classid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;classid&gt;"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"classid_unique"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;HashedUniqueClassID&gt;"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allow_student_signup"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"game_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;game’s name&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Login user to our system. Class ID is unique throughout the whole system and student ID is unique throughout the class the user is in. Student ID can be thought as an username and class ID as a password.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://analyticsdata.teachergaming.com/api/validate</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>classid</td>
<td></td>
<td>TGA Class ID</td>
</tr>
<tr>
<td>studentid</td>
<td></td>
<td>TGA studentid</td>
</tr>
<tr>
<td>apikey</td>
<td></td>
<td>Your game&rsquo;s API key</td>
</tr>
</tbody></table>

<aside class="info">
Your API key has been provided to you by TeacherGaming or hardcoded to your SDK.
</aside>

<h2 id="playing-game">Playing Game</h2>
<pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'kittn'</span>

<span class="n">api</span> <span class="o">=</span> <span class="no">Kittn</span><span class="o">::</span><span class="no">APIClient</span><span class="p">.</span><span class="nf">authorize!</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="p">.</span><span class="nf">kittens</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">kittn</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">kittn</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="s">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="o">.</span><span class="n">kittens</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl <span class="s2">"http://example.com/api/kittens/2"</span>
  -H <span class="s2">"Authorization: meowmeowmeow"</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">kittn</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'kittn'</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">api</span> <span class="o">=</span> <span class="nx">kittn</span><span class="p">.</span><span class="nx">authorize</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">max</span> <span class="o">=</span> <span class="nx">api</span><span class="p">.</span><span class="nx">kittens</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Max"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"breed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fluffiness"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cuteness"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Inform TGA that the user is currently logged in and playing. Send once every minute.</p>

<aside class="warning">Inside HTML code blocks like this one, you can&rsquo;t use Markdown, so use <code>&lt;code&gt;</code> blocks to denote code.</aside>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://analyticsdata.teachergaming.com/api/playing_game</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>classid</td>
<td>true</td>
<td>TGA Class ID</td>
</tr>
<tr>
<td>studentid</td>
<td>true</td>
<td>TGA studentid</td>
</tr>
<tr>
<td>apikey</td>
<td>true</td>
<td>Your game&rsquo;s API key</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
